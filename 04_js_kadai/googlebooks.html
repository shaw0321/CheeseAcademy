<!DOCTYPE html>
<html>

<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width">
<link rel="stylesheet" href="css/sample.css">
<title>GoogleBook検索</title>
</head>
<body>

  <header>
    <h1>GoogleBooks検索</h1>
    <p>
      <input type="text" id="keyword" >
      <button id="readbook" value="API">データ読み込み</button>
      <!-- <button id="testbutton">テスト</button> -->

    </p>
  </header>

  <main>
    <p id="content"></p>
  </main>


<script src="js/jquery-3.5.1.min.js"></script>
<script>
// 手順
// 1. $.get() を使って 情報を取得する
// 2. JSONデータ構造を基に本のタイトルを取得する
// 3. 本のタイトル情報をHTMLに出力する
// ---ここからは課題！
// 4. クリックイベントで括る
// 5. id="keyword"の入力値を取得 → URLの"?q=jquery"の"queryの文字を取得した入力値（変数）に変える"
// 6. 出版社も表示してみよう！（データ構造はconsole.logで確認！！）

// $.get() を使う[開始]
// let d = $.get("https://www.googleapis.com/books/v1/volumes?q=jquery");
// console.log(d);


$("#readbook").on("click",function(){

  let url = `https://www.googleapis.com/books/v1/volumes?q=${$("#keyword").val()}`;
  // let url1 = "https://www.googleapis.com/books/v1/volumes?q=jquery";
  // let Qiita_url = `https://qiita.com/api/v2/items?q=${$("#keyword").val()}`;

  $.get(url,function(data){
  console.log(data);
  console.log(data.items);

  let content = "";
  for(let i=0; i<data.items.length; i++){
    console.log(data.items[i]);

  content += `<ul><li>${data.items[i].volumeInfo.title}</li><li>${data.items[i].volumeInfo.publisher}</li></ul>`;  
  }
  $("#content").append(content);

  })

});







// $.get("https://www.googleapis.com/books/v1/volumes?q=knowledge manegement",function(data){

//   let content = "";


//   for(let i=0; i<data.items.length; i++){
//   console.log(data.items[i].volumeInfo);

//   content += `<ul><li>${data.items[i].volumeInfo.title}<li></ul>`;

//     // 
//   }
//   $("#content").append(content);
// })

// $.get() を使う[終了]




// // QiitaＡＰＩを使ってみる

//     // Qiitaアクセストークン
//     let Qiita_accesstoken ="e0eeda66370483211b7ca99cad25506fa494e2d8"


//     function qiitaApiTest() {
//       let articleArray = getQiitaArticle("?per_page=10");
//       articleArray.forEach(function(article){
//         article.checkVariable()
//       }); 
//     }

//     function getQiitaArticle(urlParams) {
//       const ACCESS_TOKEN = Qiita_accesstoken
//       const END_POINT = "https://qiita.com/api/v2/items"

//       let headers = {'Authorization' : 'Bearer ' + ACCESS_TOKEN};

//       let options = {
//           "method" : "GET",
//           "headers" : headers, 
//       }
      
//       //外部へアクセスさせる
//       let response = UrlFetchApp.fetch(END_POINT + urlParams, options);
//       let json = JSON.parse(response.getContentText());

//       let articleArray = [];
//       json.forEach(function(item, i){
//         let article = new QiitaArticle(item["id"], item["created_at"], item["title"], item["url"], item["likes_count"])
//         articleArray.push(article);
//       });
    
//       return articleArray;
//     }

//     class QiitaArticle {
//       constructor(id, created_at, title, url, likes_count) {
//         this.id  = id;
//         this.created_at = created_at;
//         this.title = title;
//         this.url = url;
//         this.likes_count = likes_count;
//       }

//       checkVariable() {
//         console.log("id:" + this.id + "  created_at:" + this.created_at + "  title:" + this.title + "  url:" + this.url + "  likes_count:" + this.likes_count);
//       }
//     }





// // yahooテキスト解析を使ってみある

// const request_URL = "https://jlp.yahooapis.jp/MAService/V1/parse";

// // yahooクライアントID
// const yahoo_appid = "dj00aiZpPThIQVBJNndrRmEyWCZzPWNvbnN1bWVyc2VjcmV0Jng9OGI-";

// const sentence  = "私は池辺です";
// const results = "ma";




// $("#testbutton").on("click",function(){

//   let url = "";
//   url += `${request_URL}`;
//   url += `?appid=${yahoo_appid}`;
//   url += `?results=${results}`;
//   // url += `?sentence=${sentence}`;

//   console.log(url);


//   $.get(url,function(data){
//   console.log(data);

//   // let content = "";
//   // for(let i=0; i<data.length; i++){

//   // content += `<ul><li>${data[i].title}</li></ul>`;  
//   // }
//   // $("#content").append(content);

//   })

// });




// https://jlp.yahooapis.jp/MAService/V1/parse?appid=<あなたのアプリケーションID>&results=ma,uniq&uniq_filter=9%7C10&sentence=%E5%BA%AD%E3%81%AB%E3%81%AF%E4%BA%8C%E7%BE%BD%E3%83%8B%E3%83%AF%E3%83%88%E3%83%AA%E3%81%8C%E3%81%84%E3%82%8B%E3%80%82



</script>
</body>
</html>
